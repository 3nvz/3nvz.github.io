<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Browser Info</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    pre {
      background: #f4f4f4;
      padding: 10px;
      border-radius: 6px;
    }
  </style>
</head>

<body>
  <h1>Detected Browser Information</h1>
  <pre id="output">Detecting...</pre>

  <script>
    async function detectBrowser() {
      const result = { name: 'unknown', version: 'unknown', ua: navigator.userAgent || '', source: '' };

      if (navigator.userAgentData) {
        try {
          const hints = await navigator.userAgentData.getHighEntropyValues(['platform', 'platformVersion', 'uaFullVersion', 'brands', 'fullVersionList']);
          const brands = hints.fullVersionList || hints.brands || [];
          if (brands.length) {
            const pick = brands.find(b => /chrome|firefox|safari|edge|opera/i.test(b.brand)) || brands[0];
            result.name = pick.brand;
            result.version = pick.version || hints.uaFullVersion || 'unknown';
            result.source = 'userAgentData';
            result.ua = navigator.userAgent;
            return result;
          }
        } catch (e) {
          console.warn('userAgentData high-entropy failed', e);
        }
      }

      const ua = navigator.userAgent || navigator.vendor || window.opera || '';
      result.ua = ua;
      result.source = 'userAgent';

      const rules = [
        { name: 'Edge (Chromium)', re: /Edg\/([\d.]+)/ },
        { name: 'Edge (Legacy)', re: /Edge\/([\d.]+)/ },
        { name: 'Chrome', re: /Chrome\/([\d.]+)/ },
        { name: 'Firefox', re: /Firefox\/([\d.]+)/ },
        { name: 'Safari', re: /Version\/([\d.]+).*Safari/ },
        { name: 'Opera', re: /OPR\/([\d.]+)/ }
      ];

      for (const r of rules) {
        const m = ua.match(r.re);
        if (m) {
          result.name = r.name;
          result.version = m[1] || 'unknown';
          break;
        }
      }

      return result;
    }

    detectBrowser().then(info => {
      document.getElementById('output').textContent =
        `Browser Name: ${info.name}\nVersion: ${info.version}\nUser Agent: ${info.ua}\nSource: ${info.source}`;
    });
  </script>
</body>

</html>
